# üîç Railway Deployment - –ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç –æ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏

**–î–∞—Ç–∞**: 30 —Å–µ–Ω—Ç—è–±—Ä—è 2025  
**–ü—Ä–æ–±–ª–µ–º–∞**: Backend –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ Railway, healthcheck –ø–∞–¥–∞–µ—Ç  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–ï–®–ï–ù–û

---

## üö® –ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### 1. **–ì–õ–ê–í–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê: –ö–æ–Ω—Ñ–ª–∏–∫—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π Railway**

Railway –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–∞–π–ª—ã –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–µ:
1. **`railway.json`** (–∫–æ—Ä–Ω–µ–≤–æ–π) ‚Üê Railway —á–∏—Ç–∞–µ—Ç –≠–¢–û–¢ —Ñ–∞–π–ª!
2. `railway.toml` (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è, –µ—Å–ª–∏ –µ—Å—Ç—å railway.json)
3. `backend/railway.json` (–¥–ª—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤)

#### ‚ùå –ß—Ç–æ –±—ã–ª–æ:
```json
// railway.json —É–∫–∞–∑—ã–≤–∞–ª –Ω–∞ Dockerfile (fullstack)
{
  "name": "TrendXL-Frontend",  // –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ!
  "dockerfilePath": "Dockerfile"  // Fullstack –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
}
```

#### ‚ùå –ß—Ç–æ –º—ã –ø—ã—Ç–∞–ª–∏—Å—å —Å–¥–µ–ª–∞—Ç—å (–Ω–µ —Ä–∞–±–æ—Ç–∞–ª–æ):
- –û–±–Ω–æ–≤–∏–ª–∏ `railway.toml` ‚Üí **Railway –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–ª**
- –°–æ–∑–¥–∞–ª–∏ `Dockerfile.backend` ‚Üí **Railway –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª**
- –ò–∑–º–µ–Ω–∏–ª–∏ `railway.backend.toml` ‚Üí **Railway –Ω–µ –≤–∏–¥–µ–ª**

#### ‚úÖ –ü–æ—á–µ–º—É –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–æ:
**Railway –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `railway.json` –≤ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–µ –Ω–∞–¥ `railway.toml`!**

---

### 2. **API –∫–ª—é—á–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–ª–∏—Å—å –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä**

#### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞:
```json
// railway.json –ù–ï –≤–∫–ª—é—á–∞–ª –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è backend
"variables": {
  "PORT": "${{RAILWAY_PORT}}",
  "NODE_ENV": "production"
  // ‚ùå –ù–ï–¢ ENSEMBLE_API_TOKEN
  // ‚ùå –ù–ï–¢ OPENAI_API_KEY
  // ‚ùå –ù–ï–¢ PERPLEXITY_API_KEY
}
```

Backend –ø–∞–¥–∞–ª —Å –æ—à–∏–±–∫–æ–π:
```python
ValidationError: 3 validation errors for Settings
ensemble_api_token - Field required
openai_api_key - Field required
perplexity_api_key - Field required
```

---

### 3. **Healthcheck timeout –±—ã–ª —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π**

- **–ë—ã–ª–æ**: 30 —Å–µ–∫—É–Ω–¥
- **–ù—É–∂–Ω–æ**: 60 —Å–µ–∫—É–Ω–¥ (backend –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è ~5-10 —Å–µ–∫—É–Ω–¥)

---

## ‚úÖ –†–ï–®–ï–ù–ò–ï

### –®–∞–≥ 1: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω `railway.json`

```json
{
  "name": "TrendXL-Fullstack",  // ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
  "dockerfilePath": "Dockerfile",  // ‚úÖ Fullstack –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
  "healthcheck": {
    "timeout": 60  // ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω timeout
  },
  "environments": {
    "production": {
      "variables": {
        "PYTHONPATH": "/app/backend",  // ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã backend –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        "PYTHONUNBUFFERED": "1",
        "HOST": "0.0.0.0",
        "DEBUG": "false"
      }
    }
  }
}
```

### –®–∞–≥ 2: –£–±—Ä–∞–Ω–∞ –∑–∞–¥–µ—Ä–∂–∫–∞ –∑–∞–ø—É—Å–∫–∞ –≤ production

```python
# backend/run_server.py
# ‚úÖ –¢–µ–ø–µ—Ä—å –∑–∞–¥–µ—Ä–∂–∫–∞ —Ç–æ–ª—å–∫–æ –≤ DEBUG —Ä–µ–∂–∏–º–µ
if settings.debug:
    # Wait 5 seconds (—Ç–æ–ª—å–∫–æ –¥–ª—è development)
else:
    # Start immediately (production)
```

### –®–∞–≥ 3: **–ö–†–ò–¢–ò–ß–ù–û** - –ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å API –∫–ª—é—á–∏ –≤ Railway

–í **Railway Dashboard ‚Üí Variables** –¥–æ–±–∞–≤—å—Ç–µ:

```env
ENSEMBLE_API_TOKEN=your_token_here
OPENAI_API_KEY=sk-your_key_here
PERPLEXITY_API_KEY=pplx-your_key_here
```

**‚ö†Ô∏è –ë–ï–ó –≠–¢–ò–• –ü–ï–†–ï–ú–ï–ù–ù–´–• BACKEND –ù–ï –ó–ê–ü–£–°–¢–ò–¢–°–Ø!**

---

## üìä –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

### –¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (Fullstack –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä):

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Railway Service                           ‚îÇ
‚îÇ   Port: $PORT (–æ–±—ã—á–Ω–æ 8080)                 ‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                  ‚îÇ
‚îÇ   ‚îÇ   Nginx             ‚îÇ                  ‚îÇ
‚îÇ   ‚îÇ   Port: $PORT       ‚îÇ                  ‚îÇ
‚îÇ   ‚îÇ   (Frontend + Proxy)‚îÇ                  ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                  ‚îÇ
‚îÇ              ‚îÇ                              ‚îÇ
‚îÇ              ‚îÇ Proxy /api/*                 ‚îÇ
‚îÇ              ‚ñº                              ‚îÇ
‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                  ‚îÇ
‚îÇ   ‚îÇ   Python Backend    ‚îÇ                  ‚îÇ
‚îÇ   ‚îÇ   Port: 8000        ‚îÇ                  ‚îÇ
‚îÇ   ‚îÇ   (FastAPI)         ‚îÇ                  ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                  ‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ   Supervisor —É–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±–æ–∏–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Endpoints:

- **Frontend**: `https://your-app.up.railway.app/`
- **Backend API**: `https://your-app.up.railway.app/api/*`
- **Health check**: `https://your-app.up.railway.app/health`

---

## üîß –ß–¢–û –ù–£–ñ–ù–û –°–î–ï–õ–ê–¢–¨ –°–ï–ô–ß–ê–°

### 1. ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è —É–∂–µ –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã

Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ö–≤–∞—Ç–∏—Ç:
- –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π `railway.json`
- –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π healthcheck timeout
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ backend

### 2. ‚ö†Ô∏è –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û: –î–æ–±–∞–≤–∏—Ç—å Environment Variables –≤ Railway

–ó–∞–π–¥–∏—Ç–µ –≤ **Railway Dashboard**:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
2. –í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Ä–≤–∏—Å
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Variables**
4. –î–æ–±–∞–≤—å—Ç–µ:

```env
ENSEMBLE_API_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_—Å_dashboard.ensembledata.com
OPENAI_API_KEY=sk-proj-–≤–∞—à_–∫–ª—é—á_—Å_platform.openai.com
PERPLEXITY_API_KEY=pplx-–≤–∞—à_–∫–ª—é—á_—Å_perplexity.ai
```

5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏ –ø–æ–¥–æ–∂–¥–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ redeploy

### 3. üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ health endpoint
curl https://your-app.up.railway.app/health

# –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:
{
  "status": "healthy",
  "services": {
    "backend": true,
    "ensemble_api": true,
    "openai_api": true
  }
}
```

---

## üìù LESSONS LEARNED

### 1. Railway —á–∏—Ç–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞:

```
railway.json > railway.toml > package.json
```

### 2. –ï—Å–ª–∏ –µ—Å—Ç—å `railway.json` - –æ–Ω –í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `railway.toml` –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è!

### 3. Environment Variables –ö–†–ò–¢–ò–ß–ù–´

Backend –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –±–µ–∑ API –∫–ª—é—á–µ–π - —ç—Ç–æ –Ω–µ optional!

### 4. Fullstack –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ

–ï—Å–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:
- ‚úÖ –û–¥–∏–Ω —Å–µ—Ä–≤–∏—Å –≤–º–µ—Å—Ç–æ –¥–≤—É—Ö
- ‚úÖ –û–¥–Ω–∞ –±–∞–∑–∞ –∫–æ–¥–∞
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–π –¥–µ–ø–ª–æ–π
- ‚úÖ –ú–µ–Ω—å—à–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å

---

## üéØ –†–ï–ó–£–õ–¨–¢–ê–¢

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
```
‚ùå Backend –ø–∞–¥–∞–ª —Å ValidationError
‚ùå Healthcheck timeout —á–µ—Ä–µ–∑ 30s
‚ùå Railway –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
‚ùå API –∫–ª—é—á–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–ª–∏—Å—å
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
```
‚úÖ railway.json –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –∏ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ Dockerfile
‚úÖ Healthcheck timeout —É–≤–µ–ª–∏—á–µ–Ω –¥–æ 60s
‚úÖ Backend –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É (–±–µ–∑ –∑–∞–¥–µ—Ä–∂–∫–∏)
‚úÖ API –∫–ª—é—á–∏ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ Railway Variables
```

---

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ô –î–ï–ü–õ–û–ô –î–û–õ–ñ–ï–ù –ü–û–ö–ê–ó–ê–¢–¨:

```
‚úÖ Build successful
‚úÖ Starting healthcheck at /health
‚úÖ Attempt #1: Success!
‚úÖ All services healthy
‚úÖ Deployment successful

Logs:
üöÄ Starting TrendXL 2.0 Fullstack Application...
‚úÖ All API keys configured
INFO: Uvicorn running on http://0.0.0.0:8000
```

---

## üìû –ï–°–õ–ò –ü–†–û–ë–õ–ï–ú–ê –û–°–¢–ê–ï–¢–°–Ø

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Railway Dashboard ‚Üí Variables
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ 3 API –∫–ª—é—á–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: Railway Dashboard ‚Üí Deployments ‚Üí View logs
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ—Ç–∫–∞ `main`

---

**–°–æ–∑–¥–∞–Ω–æ**: 30 —Å–µ–Ω—Ç—è–±—Ä—è 2025  
**–ê–≤—Ç–æ—Ä**: AI Assistant  
**–°—Ç–∞—Ç—É—Å**: –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é (–ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è API –∫–ª—é—á–µ–π –≤ Railway)

